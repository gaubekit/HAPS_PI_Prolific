{{ extends 'global/Page.html' }}
{{ block title }}Video Meeting{{ endblock }}

{{ block content }}

<style>
    .column {
        float: left;
        height: 80vh;
        box-sizing: border-box;
        width: 100%;
    }
    .row {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
    }
    .row:after {
        content: "";
        display: table;
        clear: both;
    }
    #meet {
        width: 100%;
        height: 100%;
    }
    @media (max-width: 1200px) {
        .row {
            max-width: 1000px;
        }
    }
    @media (max-width: 1000px) {
        .row {
            max-width: 800px;
        }
    }
    @media (max-width: 800px) {
        .row {
            max-width: 600px;
        }
    }
    @media (max-width: 600px) {
        .row {
            max-width: 100%;
        }
        .column {
            float: none;
            width: 100%;
            height: auto;
        }
    }
</style>

<div class="row">
    <div class="column">
        <div id="meet"></div>
    </div>
</div>

<br/>
<br/>
{{ next_button }}

<script src="https://haps-meeting.k8s.iism.kit.edu/external_api.js"></script>
<script>
    const domain = "haps-meeting.k8s.iism.kit.edu";
    const TN_name = "P" + {{ player.id_in_group }};

    const options = {
        roomName: "Video Meeting" + {{ player.group_id }},
        parentNode: document.querySelector('#meet'),
        configOverwrite: {
            prejoinConfig: { enabled: false },
            disableSelfView: false,
            startWithAudioMuted: false,
            startWithVideoMuted: false,
            filmstrip: { disableResizable: true },
            participantsPane: {
                hideModeratorSettingsTab: true,
                hideMoreActionsButton: true,
                hideMuteAllButton: true
            },
            resolution: 480,
            disableAEC: false,
            disableNS: false,
            constraints: {
                video: {
                    height: {
                        ideal: 480,
                        max: 480,
                        min: 240
                    }
                }
            },
            disableSimulcast: false,
            enableLayerSuspension: true
        },
        interfaceConfigOverwrite: {
            TOOLBAR_BUTTONS: ['microphone', 'camera', 'fodeviceselection'],
            SHOW_JITSI_WATERMARK: false,
            SHOW_MEETING_NAME: false,
            SHOW_MEETING_TIMER: false,
            TILE_VIEW_MAX_COLUMNS: 2,
            TILE_VIEW_ENABLED: true,
            PARTICIPANT_MENU_BUTTONS: []
        },
        userInfo: {
            displayName: TN_name,
        }
    }
    const api = new JitsiMeetExternalAPI(domain, options);
</script>

{{ endblock }}
