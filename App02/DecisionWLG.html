{{ block title }}
Stage 2: Decision - Bonus Allocation by Success
{{ endblock }}

{{ block styles }}
<style>
    .btn-primary {
        float: left;
        display: none;
        color: #fff;
        background-color: #0d6efd;
        border-color: #0d6efd
    }

    .my-box {
        border: 1px solid #ccc;
        padding: 10px;
        background-color: #f9f9f9;
    }

    .selected:not(:first-child) {
        background-color: rgba(255, 0, 0, 0.6);
        font-weight: bolder;
        color: white !important;
        transition: background-color 0.3s ease;
    }

    .radio-group {
        display: flex;
        gap: 20px;
        margin-top: 20px;
    }
</style>
{{ endblock }}

{{ block content }}

<div class="my-box">
    On this page you must make the decision that determine your bonus payoff for Stage 2.
    The 'Next'-Button will become available after selecting <span style="color: rgba(54, 162, 235, 1);">your preferred contribution</span> to the team project via radio button.
    Identical to the previous pages, the payoff table shows your potential bonus payoff, depending on the <span style="color: rgba(255, 99, 132, 1);">minimum contribution of any team member</span>.
    <br><br>
    {{ include_sibling 'PayoffTable.html' }}
    <br>
    <b> Please decide now how many hours you would like to allocate to the team project:</b>
    <br>
    <label for="ownDecision0">
        <input type="radio" id="ownDecision0" name="ownDecision_subround1" value="0"> 0 &nbsp;&nbsp;
    </label>
    <label for="ownDecision10">
        <input type="radio" id="ownDecision10" name="ownDecision_subround1" value="10"> 10 &nbsp;&nbsp;
    </label>
    <label for="ownDecision20">
        <input type="radio" id="ownDecision20" name="ownDecision_subround1" value="20"> 20 &nbsp;&nbsp;
    </label>
    <label for="ownDecision30">
        <input type="radio" id="ownDecision30" name="ownDecision_subround1" value="30"> 30 &nbsp;&nbsp;
    </label>
    <label for="ownDecision40">
        <input type="radio" id="ownDecision40" name="ownDecision_subround1" value="40"> 40 &nbsp;&nbsp;
    </label>

</div>
<br>

 {{ next_button }}


{{ endblock }}

{{ block scripts }}
<script>

 document.addEventListener("DOMContentLoaded", function() {
    const nextBtn = document.querySelector(".btn-primary");
    let row = document.querySelector("tbody").children[3];
    let rowA = Array.from(row.children);
    rowA.shift();
    const radioButtons = document.querySelectorAll('input[name="ownDecision_subround1"]');
    radioButtons.forEach(radio => {
        radio.addEventListener("change", function() {
            const val = this.value;
            switch (val) {
                case "0":
                    updateSelection(1);
                    break;
                case "10":
                    updateSelection(2);
                    break;
                case "20":
                    updateSelection(3);
                    break;
                case "30":
                    updateSelection(4);
                    break;
                case "40":
                    updateSelection(5);
                    break;
                default:
                    nextBtn.style.display = "none";
            }
        });

    });

    function updateSelection(rowIndex) {
        rowA.forEach(el => el.classList.remove("selected"));
        row = document.querySelector("tbody").children[rowIndex];
        rowA = Array.from(row.children);
        rowA.shift();
        rowA.forEach(el => el.classList.add("selected"));
        nextBtn.style.display = "block";
    }
});
     document.onsubmit = () => {
            console.log("Next button clicked 2");
            const radios = document.getElementsByName("ownDecision_subround1");
            let selectedValue;
            for (const radio of radios) {
                if (radio.checked) {
                    selectedValue = radio.value;
                    break;
                }
            }

            liveSend({
                "ownDecision_subround1": parseInt(selectedValue)
            });
            }
</script>

{{ endblock }}
