{{ block title }}
Stage 2: Decision - Bonus Payoff 2
{{ endblock }}

{{ block styles }}
<style>
    .btn-primary {
        float: left;
        display: none;
        color: #fff;
        background-color: #0d6efd;
        border-color: #0d6efd
    }

    .my-box {
        border: 1px solid #ccc;
        padding: 10px;
        background-color: #f9f9f9;
    }

    .selected:not(:first-child) {
        background-color: rgba(255, 0, 0, 0.6);
        font-weight: bolder;
        color: white !important;
        transition: background-color 0.3s ease;
    }

    .radio-group {
        display: flex;
        gap: 20px;

    }
</style>
{{ endblock }}

{{ block content }}

<div class="my-box">
    On this page you must make the decision that determine your bonus payoff for Stage 2.
    The 'Next'-Button will become available after selecting <span style="color: rgba(54, 162, 235, 1);">your preferred contribution</span> to the team project via radio button.
    Identical to the previous pages, the payoff table shows your potential bonus payoff, depending on the <span style="color: rgba(255, 99, 132, 1);">minimum contribution of any team member</span>.
    <br><br>

    <h4 class="card-title text-center">Payoff Table</h4>
    {{ include_sibling 'PayoffTable.html' }}

    Please <b>decide now</b> how many hours you would like to allocate to the team project:
    <div class="radio-group">
        <span><span style="color: rgba(54, 162, 235, 1);">Your</span> contribution:</span>
        <label><input type="radio" name="wlg_decision" value="0"> 0 hours</label>
        <label><input type="radio" name="wlg_decision" value="10"> 10 hours</label>
        <label><input type="radio" name="wlg_decision" value="20"> 20 hours</label>
        <label><input type="radio" name="wlg_decision" value="30"> 30 hours</label>
        <label><input type="radio" name="wlg_decision" value="40"> 40 hours</label>
    </div>

</div>
<br>

 {{ next_button }}


{{ endblock }}

{{ block scripts }}
<script>

 document.addEventListener("DOMContentLoaded", function() {
    const nextBtn = document.querySelector(".btn-primary");
    let row = document.querySelector("tbody").children[3];
    let rowA = Array.from(row.children);
    rowA.shift();
    const radioButtons = document.querySelectorAll('input[name="wlg_decision"]');
    radioButtons.forEach(radio => {
        radio.addEventListener("change", function() {
            const val = this.value;
            switch (val) {
                case "0":
                    updateSelection(1);
                    break;
                case "10":
                    updateSelection(2);
                    break;
                case "20":
                    updateSelection(3);
                    break;
                case "30":
                    updateSelection(4);
                    break;
                case "40":
                    updateSelection(5);
                    break;
                default:
                    nextBtn.style.display = "none";
            }
        });

    });

    function updateSelection(rowIndex) {
        rowA.forEach(el => el.classList.remove("selected"));
        row = document.querySelector("tbody").children[rowIndex];
        rowA = Array.from(row.children);
        rowA.shift();
        rowA.forEach(el => el.classList.add("selected"));
        nextBtn.style.display = "block";
    }
});
     document.onsubmit = () => {
            console.log("Next button clicked 2");
            const radios = document.getElementsByName("wlg_decision");
            let selectedValue;
            for (const radio of radios) {
                if (radio.checked) {
                    selectedValue = radio.value;
                    break;
                }
            }

            liveSend({
                "wlg_decision": parseInt(selectedValue)
            });
            }
</script>

{{ endblock }}
